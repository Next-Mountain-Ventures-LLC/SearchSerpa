---
import { buttonVariants } from "@/components/ui/button";
---

<button
  id="mobile-menu-toggle"
  class="md:hidden p-2 rounded-md hover:bg-muted/50 transition-colors duration-200"
  aria-label="Toggle mobile menu"
>
  <!-- Hamburger Icon -->
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
    id="hamburger-icon"
  >
    <line x1="4" y1="6" x2="20" y2="6"></line>
    <line x1="4" y1="12" x2="20" y2="12"></line>
    <line x1="4" y1="18" x2="20" y2="18"></line>
  </svg>

  <!-- Close Icon -->
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    stroke-linecap="round"
    stroke-linejoin="round"
    class="hidden"
    id="close-icon"
  >
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>
</button>

<div
  id="mobile-menu"
  class="fixed right-0 top-16 w-full md:hidden h-[calc(100vh-4rem)] bg-background shadow-lg z-50 border-t border-border translate-x-full transition-transform duration-300"
>
  <div class="p-6 flex flex-col h-full">
    <nav class="space-y-4">
      <a href="#services" class="block text-xl py-3 border-b border-border hover:text-primary transition-colors">
        Services
      </a>
      <a href="#why-different" class="block text-xl py-3 border-b border-border hover:text-primary transition-colors">
        Why We're Different
      </a>
      <a href="#pricing" class="block text-xl py-3 border-b border-border hover:text-primary transition-colors">
        Pricing
      </a>
      
      <div class="pt-6 space-y-4">
        <button id="mobile-audit-btn" class={buttonVariants({ variant: 'default', size: 'lg', class: "w-full" })}>
          Get Free Audit
        </button>
        <a href="https://nxtmt.bloom.io/login" target="_blank" rel="noopener noreferrer" class="block">
          <button class={buttonVariants({ variant: 'outline', size: 'lg', class: "w-full" })}>
            Login
          </button>
        </a>
      </div>
    </nav>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const menuToggle = document.getElementById('mobile-menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  const hamburgerIcon = document.getElementById('hamburger-icon');
  const closeIcon = document.getElementById('close-icon');
  const auditBtn = document.getElementById('mobile-audit-btn');
  const mobileLinks = document.querySelectorAll('#mobile-menu a');
  
  // Function to toggle the mobile menu
  function toggleMenu() {
    const isOpen = mobileMenu.classList.contains('translate-x-0');
    
    if (isOpen) {
      // Close menu
      mobileMenu.classList.remove('translate-x-0');
      mobileMenu.classList.add('translate-x-full');
      hamburgerIcon.classList.remove('hidden');
      closeIcon.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    } else {
      // Open menu
      mobileMenu.classList.add('translate-x-0');
      mobileMenu.classList.remove('translate-x-full');
      hamburgerIcon.classList.add('hidden');
      closeIcon.classList.remove('hidden');
      document.body.classList.add('overflow-hidden');
    }
  }
  
  // Toggle menu when the button is clicked
  if (menuToggle) {
    menuToggle.addEventListener('click', toggleMenu);
  }
  
  // Close menu when links are clicked
  mobileLinks.forEach(link => {
    link.addEventListener('click', toggleMenu);
  });
  
  // Handle the audit button
  if (auditBtn) {
    auditBtn.addEventListener('click', (e) => {
      e.preventDefault();
      
      // Close the mobile menu
      toggleMenu();
      
      // Get the header height for offset
      const headerHeight = document.querySelector('header')?.offsetHeight || 64;
      const targetElement = document.getElementById('site-audit-section');
      
      if (targetElement) {
        const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
        
        // Scroll to the element with the header offset
        window.scrollTo({
          top: elementPosition - headerHeight - 20,
          behavior: 'smooth'
        });
      }
    });
  }
});
</script>