---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Image } from 'astro:assets';
import { type WpPost } from "@/lib/wordpress";

interface Props {
  title?: string;
  description?: string;
  ogImage?: URL;
  post?: WpPost;
}

const { title, description, ogImage, post } = Astro.props;
---

<BaseLayout title={title} description={description} ogImage={ogImage}>
  <div class="relative">
    <!-- Background accent decoration -->
    <div class="absolute inset-0 overflow-hidden">
      <div class="absolute top-0 left-0 right-0 h-80 bg-gradient-to-b from-accent/30 to-transparent -z-10" aria-hidden="true"></div>
    </div>
    
    <!-- Breadcrumb navigation -->
    <div class="container pt-8 pb-4">
      <nav class="text-sm text-muted-foreground" aria-label="Breadcrumb">
        <ol class="flex items-center gap-2">
          <li>
            <a href="/" class="hover:text-primary transition-colors">Home</a>
          </li>
          <li class="flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"/></svg>
            <a href="/blog" class="hover:text-primary transition-colors">Blog</a>
          </li>
          {post && (
            <li class="flex items-center gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"/></svg>
              <span class="text-foreground truncate max-w-[200px] sm:max-w-xs md:max-w-sm" aria-current="page">{post.title.rendered}</span>
            </li>
          )}
        </ol>
      </nav>
    </div>
    
    <!-- Main content -->
    <main class="container pb-20">
      <!-- Blog post header (if post is provided) -->
      {post && (
        <header class="mb-12">
          <div class="flex flex-col gap-4 max-w-3xl">
            <h1 class="text-3xl md:text-4xl font-bold leading-tight" set:html={post.title.rendered} />
          </div>
        </header>
      )}
      
      <!-- Main blog content from slot -->
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
        <div class="lg:col-span-8 blog-content">
          <slot />
        </div>
        
        <!-- Sidebar (on desktop) -->
        <aside class="lg:col-span-4">
          <div class="sticky top-24 space-y-8">
            <!-- Categories widget -->
            <slot name="sidebar-categories" />
            
            <!-- Recent posts widget -->
            <slot name="sidebar-recent" />
            
            <!-- Tags widget -->
            <slot name="sidebar-tags" />
            
            <!-- CTA card -->
            <div class="rounded-lg bg-accent/20 p-6 border border-accent">
              <h3 class="text-lg font-bold mb-3">Need SEO Help?</h3>
              <p class="text-sm mb-4">Let SearchSerpa guide your business to the top of search results.</p>
              <a href="/#pricing" class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors bg-primary text-primary-foreground h-10 px-4 py-2 w-full">
                View Pricing
              </a>
            </div>
          </div>
        </aside>
      </div>
    </main>
  </div>
</BaseLayout>

<style>
  /* WordPress content styling */
  .blog-content {
    max-width: none;
  }
  
  .blog-content h2 {
    font-size: 1.5rem;
    font-weight: bold;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }
  
  .blog-content h3 {
    font-size: 1.25rem;
    font-weight: bold;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }
  
  .blog-content p {
    margin-bottom: 1rem;
    line-height: 1.7;
  }
  
  .blog-content ul, .blog-content ol {
    margin: 1rem 0;
    margin-left: 1.5rem;
  }
  
  .blog-content li {
    margin-bottom: 0.5rem;
  }
  
  .blog-content a {
    color: hsl(var(--primary));
  }
  
  .blog-content a:hover {
    text-decoration: underline;
  }
  
  .blog-content img {
    border-radius: 0.5rem;
    margin: 1.5rem 0;
    max-width: 100%;
    height: auto;
  }
  
  .blog-content blockquote {
    border-left: 4px solid hsl(var(--primary));
    padding-left: 1rem;
    font-style: italic;
    margin: 1.5rem 0;
  }
  
  .blog-content code {
    background-color: hsl(var(--muted));
    padding: 0.125rem 0.25rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
  }
  
  .blog-content pre {
    background-color: hsl(var(--muted));
    padding: 1rem;
    border-radius: 0.5rem;
    margin: 1.5rem 0;
    overflow-x: auto;
  }
  
  /* Fix WordPress embedded content */
  .blog-content iframe {
    max-width: 100%;
    margin: 1.5rem 0;
  }
</style>